---
title: "R Markdown Demo"
author: "Hendrik Nunner"
date: "`r Sys.Date()`"
bibliography: bibliography.bib
csl: apa7.csl
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
```

```{r data, include = FALSE}
# Daten importieren mit 'read.csv' - schauen Sie hierzu bitte in die Hilfe (RStudio > Reiter "Help" > "R Help")
ueq <- read.csv("UEQ_Two-Products.csv", sep = ";")
```


<!-- ###################### EINLEITUNG ###################### -->
# Einleitung

Im ersten Absatz wird der Kontext erläutert. Dieser bezieht sich beispielsweise auf die gesellschaftlichen Rahmenbedingungen.

Im zweiten Absatz wird dann erläutert welche für den Kontext relevante Forschung bisher getätigt wurde. Hier könnten auch ein paar Referenzen stehen [@layte_why_2017; @lunn_case_2018]. @liu_markov-based_2020 hat sicherlich auch tolle Forschung betrieben.

Im dritten Absatz steht dann die konkrete Forschungsfrage und wie diese erforscht wird.


<!-- ###################### RESULTATE ###################### -->
# Resultate

Hier stehen die Ergebnisse der Datenerhebung und der statistischen Auswertung.

## Methode

Hier wird beschrieben wie die Daten erhoben wurden.

## Daten

Hier befindet sich die Beschreibung der Daten (deskriptive Statistik). Beispiele (vielleicht nicht immer sinvoll) werden im Anschluss gezeigt.

```{r inspizieren, echo = FALSE}
# Geben Sie aus der Spalte "wertvoll_minderwertig" die ersten vier Datenpunkte aus.
wm_top4 <- ueq$wertvoll_minderwertig[1:4]
# Subset für Produkt 1
ueq_1 <- subset(ueq, Produkt == 1)
# Subset für Produkt 2
ueq_2 <- subset(ueq, Produkt == 2)
```
Die ersten vier Datenpunkte der Spalte "wertvoll_minderwertig" lauten: `r wm_top4`. Desweiteren wurde, auf einer Skala von gut (`r min(ueq$gut_schlecht)`) bis schlecht (`r max(ueq$gut_schlecht)`), Produkt 1 im Schnitt mit `r round(mean(ueq_1$gut_schlecht), 3)` bewertet. Produkt 2 hingegen wurde im Schnitt mit `r round(mean(ueq_2$gut_schlecht), 3)` leicht besser bewertet. Ob diese Differenz signifikant ist, muss allerdings noch ein weiterer Test bestätigen.

```{r verändern, echo = FALSE}
# Benennen Sie die Spalte “sicher_unsicher” in “safe_unsafe” um. Suchen Sie hierzu nach dem passenden Befehl in der Suchmaschine Ihrer Wahl.
names(ueq)[names(ueq)=="sicher_unsicher"] <- "safe_unsafe"

# Fügen Sie die Spalte “Geschlecht” hinzu.
geschlecht <- factor(sample(c(rep("männlich", 75), 
                              rep("weiblich", 82), 
                              rep("divers", 9), 
                              rep("keine Angabe", 31))))
ueq$geschlecht <- geschlecht
```

Eine Übersicht der Geschlechter der Probanden befindet sich in Tabelle 1.
```{r geschlecht, echo = FALSE}
kable(
  summary(ueq$geschlecht), 
  col.names = c("Anzahl"), 
  align = "r", 
  caption = "Tabelle 1: Übersicht der Geschlechter.")
```

Ab hier befinden sich die neuen Übungen, basierend auf den DataCamp-Tidyverse-Übungen aus Übungswoche 4.
```{r wrangling-and-summarizing, echo = FALSE}
# Erzeugen Sie ein neues Dataframe mit Hilfe der Tidyverse Funktionen "filter()" und "arrange()". Das neue Dataframe sollte nur Produkte des Typs 1 und Bewertungen für "unerfreulich_erfreulich" größer als 3 enthalten. Desweiteren sollen die Daten sortiert werden, so dass die erfreulichsten Bewertungen zuerst genannt werden.


# Fügen Sie eine neue Spalte mithilfe von "mutate()" hinzu. Diese soll angeben ob sich eine Versuchsperson als "weiblich" gekennzeichnet hat. Wenn ja, soll in der neuer Spalte "weiblich" stehen, wenn nicht, dann "nicht weiblich". Tipp: Schauen Sie sich hierzu den R-Befehl "ifelse()" an.

# min, mean, median, max für Variable "unerfreulich_erfreulich" mit summarize() ausschließlich für produkt 2 (filter())

# min, mean, median, max für Variable "unerfreulich_erfreulich" mit summarize() für beide Produkte in einer Ausgabe (group_by())

options(dplyr.summarise.inform = FALSE)

freu_verst <- ueq %>% 
  filter(!is.na(unerfreulich_erfreulich), !is.na(unverständlich_verständlich)) %>%
  select(unerfreulich_erfreulich, unverständlich_verständlich, Produkt) %>% 
  mutate(wie_erfreulich = ifelse(unerfreulich_erfreulich < 3, 
                                "(eher) unerfreulich", 
                                ifelse(unerfreulich_erfreulich == 3,
                                       "neutral",
                                       "(eher) erfreulich")),
         wie_erfreulich = factor(wie_erfreulich, levels = c("(eher) unerfreulich", "neutral", "(eher) erfreulich"))) %>% 
  group_by(Produkt, wie_erfreulich) %>% 
  summarize(verständlich_mean = mean(unverständlich_verständlich),
            verständlich_median = median(unverständlich_verständlich),
            verständlich_min = min(unverständlich_verständlich),
            verständlich_max = max(unverständlich_verständlich))

```

In Tabelle 2 wird der Zusammenhang zwischen Erfreulichkeit und Verständlichkeit dargestellt:
```{r tab-erfreulich-verständlich, echo = FALSE}
kable(
  freu_verst, 
  col.names = c("Produkt", "Erfreulichkeit", "Verständlichkeit (mean)", "Verständlichkeit (median)", "Verständlichkeit (min)", "Verständlichkeit (max)"), 
  align = "llcccc", 
  caption = "Tabelle 2: Zusammenhang zwischen der Erfreulichkeit und Verständlichkeit von Produkt X.")
```

In Abbildung 1 wird der Zusammenhang zwischen Erfreulichkeit und Verständlichkeit dargestellt:
```{r abb-erfreulich-verständlich, echo = FALSE}
library(ggplot2)
ggplot(ueq %>% 
         filter(!is.na(unerfreulich_erfreulich), !is.na(unverständlich_verständlich)), 
       aes(x = unerfreulich_erfreulich, 
           y = unverständlich_verständlich)) + 
  geom_point(position = "jitter")
```



# Literaturverzeichnis

<div id="refs"></div>

